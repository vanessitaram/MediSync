@page
@model MediSync.Pages.PacientesPages.RegistroModel

@{
    Layout = null;
    ViewData["Title"] = "Registro de paciente";
}

<link rel="stylesheet" href="~/css/login/login.css" />
<link rel="stylesheet" href="~/css/login/modal.css" />

<div class="login-wrapper">
    <div class="login-left">
        <div class="login-left-content">
            <img src="~/lib/images/logob.png" alt="MediSync" class="login-logo" />
            <h1>MediSync</h1>
            <p>Tu salud, sincronizada con tecnología.</p>
        </div>
    </div>

    <div class="login-right">
        <div class="login-card">
            <h2>Crear cuenta</h2>
            <p>Completa tus datos</p>

            <form method="post" class="login-form">
                <input class="form-control mb-2" id="Nombre" name="Nombre" placeholder="Nombre completo" required />
                <input class="form-control mb-2" id="Edad" name="Edad" placeholder="Edad" type="number" min="1" required />
                <input class="form-control mb-2" id="Sexo" name="Sexo" placeholder="Sexo (M/F)" maxlength="1" required />
                <input class="form-control mb-2" id="Telefono" name="Telefono" placeholder="Teléfono" maxlength="10" pattern="\d{10}" required />
                <input class="form-control mb-2" id="Correo" name="Correo" placeholder="Correo (opcional)" type="email" />

                <div class="password-container">
                    <input class="form-control mb-2" id="Contrasena" name="Contrasena" placeholder="Contraseña" type="password" minlength="8" required />
                    <button type="button" class="toggle-pass" data-target="Contrasena">👁</button>
                </div>

                <div class="password-container">
                    <input class="form-control mb-3" id="ConfirmarContrasena" name="ConfirmarContrasena" placeholder="Confirmar contraseña" type="password" required />
                    <button type="button" class="toggle-pass" data-target="ConfirmarContrasena">👁</button>
                </div>

                <h5 class="mt-3 mb-2 text-primary">Contacto de Emergencia</h5>
                <input class="form-control mb-2" id="NombreContacto" name="NombreContacto" placeholder="Nombre del contacto" required />
                <input class="form-control mb-2" id="TelefonoContacto" name="TelefonoContacto" placeholder="Teléfono del contacto" maxlength="10" pattern="\d{10}" required />
                <input class="form-control mb-3" id="ParentescoContacto" name="ParentescoContacto" placeholder="Parentesco" required />

                <button type="submit" class="btn-login">Registrar</button>

                <p class="register-text">
                    ¿Ya tienes cuenta?
                    <a asp-page="Login">Inicia sesión</a>
                </p>
            </form>

            @if (!string.IsNullOrEmpty(Model.Mensaje))
            {
                <div class="msg">@Model.Mensaje</div>
            }
        </div>
    </div>
</div>

<!-- Modal de éxito -->
<div id="successModal" class="modal">
    <div class="modal-content">
        <h3>¡Registro exitoso!</h3>
        <p>Tu cuenta se ha creado correctamente. Serás redirigido al inicio de sesión.</p>
        <button id="btnIrLogin">Ir a iniciar sesión</button>
    </div>
</div>

<script src="~/js/login/transition.js"></script>
<script src="~/js/login/validacionRegistro.js"></script>

@if (Model.RegistroExitoso)
{
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const modal = document.getElementById("successModal");
            const btn = document.getElementById("btnIrLogin");
            modal.style.display = "flex";

            btn.addEventListener("click", () => {
                window.location.href = "/Pacientes/Login";
            });

            setTimeout(() => {
                window.location.href = "/Pacientes/Login";
            }, 4000);
        });
    </script>
}
